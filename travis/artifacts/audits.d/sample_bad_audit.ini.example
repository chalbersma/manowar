[GLOBAL]

jellyfishversion = 2

; Sample CVE Needs to be unique across all of the pkgsample
[USN-bad]

; pkgname
vuln-name="USN-bad"
; Short Description
vuln-short-description="Several security issues were fixed in ImageMagick."
; Long Description Multiline needs
vuln-long-description="Nikolay Ermishkin and Stewie discovered that ImageMagick incorrectly
							sanitized untrusted input. A remote attacker could use these issues to
							execute arbitrary code. These issues are known as "ImageTragick". This
							update disables problematic coders via the /etc/ImageMagick-6/policy.xml
							configuration file. In certain environments the coders may need to be
							manually re-enabled after making sure that ImageMagick does not process
							untrusted input. (CVE-2016-3714, CVE-2016-3715, CVE-2016-3716,
							CVE-2016-3717, CVE-2016-3718)
							Bob Friesenhahn discovered that ImageMagick allowed injecting commands via
							an image file or filename. A remote attacker could use this issue to
							execute arbitrary code. (CVE-2016-5118)"
							
; Primary Link 
vuln-primary-link="http://www.ubuntu.com/usn/usn-2990-1/"
; (Optional) Additional Link
vuln-additional-links ={ "CVE-2016-3714" : "http://people.canonical.com/~ubuntu-security/cve/2016/CVE-2016-3714.html",
							"CVE-2016-3715" : "http://people.canonical.com/~ubuntu-security/cve/2016/CVE-2016-3715.html",
							"CVE-2016-3717" : "http://people.canonical.com/~ubuntu-security/cve/2016/CVE-2016-3717.html",
							"CVE-2016-3716" : "http://people.canonical.com/~ubuntu-security/cve/2016/CVE-2016-3716.html",
							"CVE-2016-3718" : "http://people.canonical.com/~ubuntu-security/cve/2016/CVE-2016-3718.html",
							"CVE-2016-5118" : "http://people.canonical.com/~ubuntu-security/cve/2016/CVE-2016-5118.html",
						}

; Priority Int between 0-10. 5 is the Default
vuln-priority=5

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
; Filter Types
; Use filters to match a subset of the hosts
; is = collection in ( string | [ list ] )
; match = re.search ( regexstring, collection ) | Pass if it returns something
; nematch = re.search (regexstring, collection ) | Pass if it returns nothing
; gt = collection > int
; lt = colleciton < int
; eq = collection == int
; Apt Matches
; aptis = collection in ( string | [ list ] )
; aptmatch  = re.search (regexstring, collection )
; aptis = collection in ( string | [ list ] )
; aptge = apt_pkg.version_compare( match, collection )
; if match is greater than or equal to collection
filters={ "precise-bucket" : { "filter-match" : "is",
						"filter-collection-type" : "release",
						"filter-collection-subtype" : "default",
						"filter-match-value" : "precise"},
		  "trusty-bucket" : { "filter-match" : "is",
						"filter-collection-type" : "release",
						"filter-collection-subtype" : "default",
						"filter-match-value" : "trusty"},
		  "xenial-bucket" : { "filter-match" : "is",
						"filter-collection-type" : "release",
						"filter-collection-subtype" : "default",
						"filter-match-value" : "xenial"} }
						
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
; Comparison types
; Use comparison to see if filtered hosts are vulnerable
; is = collection in ( string |  [ list ] )
; match = re.search ( regexstring, collection )
; gt = collection > int
; lt = colleciton < int
; eq = collection == int
; Apt Matches
; aptis = collection in ( string | [ list ] )
; aptmatch  = re.search (regexstring, collection )
; aptis = collection in ( string | [ list ] )
; aptge = apt_pkg.version_compare( match, collection )
; if match is greater than or equal to collection
comparisons={ "precise-bucket" : { "comparison-match" : "aptge",
							"comparison-collection-type" : [ "packages", "packages", "packages", "packages" ],
							"comparison-collection-subtype" : [ "imagemagick-common", "libmagickcore4", "imagemagick", "libmagick++4" ],
							"comparison-match-value" : [ "8:6.6.9.7-5ubuntu3.4", "8:6.6.9.7-5ubuntu3.4", "8:6.6.9.7-5ubuntu3.4", "8:6.6.9.7-5ubuntu3.4" ] },
			  "trusty-bucket" : { "comparison-match" : "aptge",
							"comparison-collection-type" : [ "packages", "packages", "packages", "packages" ],
							"comparison-collection-subtype" : [ "imagemagick-common", "libmagickcore5", "imagemagick", "libmagick++5" ],
							"comparison-match-value" : [ "8:6.7.7.10-6ubuntu3.1", "8:6.7.7.10-6ubuntu3.1", "8:6.7.7.10-6ubuntu3.1", "8:6.7.7.10-6ubuntu3.1" ] },
			  "xenial-bucket" : { "comparison-match" : "aptge",
							"comparison-collection-type" : [ "packages", "packages", "packages", "packages", "packages" ],
							"comparison-collection-subtype" : [ "libmagick++-6.q16-5v5", "imagemagick-common", "imagemagick", "imagemagick-6.q16", "libmagickcore-6.q16-2" ] ,
							"comparison-match-value" : [ "8:6.8.9.9-7ubuntu5.1", "8:6.8.9.9-7ubuntu5.1", "8:6.8.9.9-7ubuntu5.1", "8:6.8.9.9-7ubuntu5.1", "8:6.8.9.9-7ubuntu5.1" ]  } }

