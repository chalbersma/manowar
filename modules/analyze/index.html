<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Analyze - Man o' War Documentation</title>
  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Analyze";
    var mkdocs_page_input_path = "modules/analyze.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Man o' War Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Man o' War</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../authentication/">Authentication</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../db_setup/">DB Setup</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../overview/">Man o' War</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Modules</span>
    <ul class="subnav">
                <li class=" current">
                    
    <a class="current" href="./">Analyze</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#analyze">Analyze</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#introduction">Introduction</a></li>
        
            <li><a class="toctree-l4" href="#audits">Audits</a></li>
        
            <li><a class="toctree-l4" href="#analyze-architecture">Analyze Architecture</a></li>
        
            <li><a class="toctree-l4" href="#generic-large-analysis-store">Generic Large Analysis Store</a></li>
        
            <li><a class="toctree-l4" href="#future-state">Future State</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../canonical_cve/">Canonical CVE</a>
                </li>
                <li class="">
                    
    <a class="" href="../collate/">Collate</a>
                </li>
                <li class="">
                    
    <a class="" href="../collection_archive/">Collection Archive</a>
                </li>
                <li class="">
                    
    <a class="" href="../collector/">Collector</a>
                </li>
                <li class="">
                    
    <a class="" href="../scheduler/">Scheduler</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Man o' War Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Modules &raquo;</li>
        
      
    
    <li>Analyze</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="analyze">Analyze</h1>
<h2 id="introduction">Introduction</h2>
<p>The analyze module runs independently. It will, using the audits as defined in
<code>audits.d</code> directory, analyze the collections table to find out which hosts passed
or failed the audits. Then it stores the results in the <code>audits_by_host</code> table.
It assigns a unique audit result id, the id numbers for the host and audit, the
timestamps associated with this result, which bucket this result is in the result
&amp; optionally the result text.</p>
<p>These audit results power the dashboard that is used by jellyfish and are the
expected way to interact and process data within the Jellyfish system.</p>
<h2 id="audits">Audits</h2>
<p>Audits are stored in the
<a href="pages">jellyfishaudits</a>
project. There you'll find some documentation on the content and structure of
documentation that's available to you.</p>
<h2 id="analyze-architecture">Analyze Architecture</h2>
<p><img alt="Analyze Code Architecture" src="/plantuml/analyze_diagram.svg" /></p>
<p>The general idea of analyze is quite simple. The process :</p>
<ol>
<li>Grabs a lists of hosts</li>
<li>Uses <code>generic_large_compare</code> to find out which hosts are in which bucket</li>
<li>For Each Bucket:<ul>
<li>Uses either <code>generic_large_compare</code> or <code>subtype_large_compare</code> to compute
  passing or failing scores.</li>
<li>Uses <code>generic_large_analysis_store</code> to store results in <code>audits_by_host</code>
  table in the database.</li>
</ul>
</li>
</ol>
<h2 id="generic-large-analysis-store">Generic Large Analysis Store</h2>
<p>This module is a big part of the reason that autocommits were turned off. By batching
up all the inserts/updates together we avoid an row locking race condition on the
database.</p>
<h2 id="future-state">Future State</h2>
<p>This is a candidate for creating a lambda esque method of generating this data.
Because of the nature of lambda you could simplify this code to check one host
against one audit where every check will see which (or if) bucket it falls into
and then flood your DB using lambda execution limits to make sure you dont' hammer
your database.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../canonical_cve/" class="btn btn-neutral float-right" title="Canonical CVE">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../overview/" class="btn btn-neutral" title="Man o' War"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../../overview/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../canonical_cve/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
