language: python

sudo: required

notifications:
  email:
    recipients:
      - chris+manowar@halbersma.us
  on_success: always
  on_failure: always

before_script:
  - pwd
  - ls
  - ls ~/
  - cat ~/.ssh/id_rsa
  - cat ~/.ssh/authorized_keys
  - sudo apt-get -y install openssh-server
  - ./travis/pre_build.sh
  - export DEBIAN_FRONTEND=noninteractive; sudo -E apt-get -y  install python3-pip python-dev shellcheck mariadb-server mariadb-client jq openjdk-7-jre graphviz
  - ./travis/db_setup.sh
  - sudo pip3 install --upgrade setuptools
  - sudo pip3 install bandit pylint paramiko pymysql colorama flask flask_cors jsonschema feedparser lxml pika mkdocs
  - gem install mdl

script:
  - ./travis/testing.sh
  - ./travis/swagger_test.sh
  - ./travis/api_test.sh
  - ./travis/sapi_test.sh
  - ./travis/schedule_test.sh
  - ./travis/analyze_test.sh
  - ./travis/build_diag.sh

after_success:
  - ./travis/swagger_build.sh
  - ./travis/build_docs.sh
